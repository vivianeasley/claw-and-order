<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lawful Purrr-suation</title>
    <style>*{box-sizing:border-box;margin:0}.c{font-size:100px;width:66px;height:82px;background:#fff;border-radius:3px;position:relative;line-height:.72;display:inline-block;vertical-align:top;margin:2px;cursor:pointer;overflow:hidden}.a{min-height:60px;margin:0 0 10px;position:relative;border:5px ridge grey;min-height:98px;background:#fff}.h{height:98px}.d .c{background:#000;position:absolute;inset:0}.d .c:after{background:#fff;content:"\1f0a0";position:absolute;inset:0;color:#000!important}.t .c:not(:last-child){width:20px;margin:0}.sun{font-size:75px}.cw{position:relative;pointer-events:none}.cl,.cr{position:absolute;bottom:0;width:325px;transition:transform 1s ease-out}.cl{left:0}.cr{right:0}.cr.hi{transform:translate(300px)}.cl.hi{transform:translate(-300px)}.controls div{margin:6px;min-height:23px;background:#f1f1f1}.controls div button{float:right;padding:2px;cursor:pointer}.stats span{color:red;font-weight:700}.container{display:flex}.container.below{position:absolute;bottom:0;left:0;right:0;height:200px;opacity:1;transition:transform 1s ease-out}.container.below.hi{transform:translateY(-600px)}.boxes{border:5px ridge grey;background:#fff}.item-left,.item-right,.item-center,.item-bottom-left{position:relative;z-index:2;padding:1px;min-height:98px;max-height:196px;margin:0 2px 4px}.item-left{width:86px;height:98px}.item-bottom-left{width:120px;padding:6px}.item-right{width:275px}.item-center{flex-grow:1;overflow-x:auto}.te{padding:6px}.start-hide{display:none}.enable-transitions{transition:all .2s ease-in-out}.center{text-align:center}.story,.game-area-wrapper{transition:all 1.5s ease-out}.card-transitions{transition:all .2s ease-in-out}.main{height:100vh;max-height:450px;max-width:1000px;margin:0 auto;overflow:hidden;position:relative;text-align:center}.table{background-image:url(data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAADdAQAAAABWZ/VNAAAAXElEQVR4Aa1LBxHAQAiLFKRUClIqBSlIqZQSct3j1q8sApZhN07aG3PH2Bu+c96UNB291Z+Vl/cLs2Xt2LAdmfzwjkBuqjBgSm4MztmTUtazqfd2Jaa/ovJdDT4rUQZeAU+TvGEAAAAASUVORK5CYII=);background-position:0%;background-repeat:repeat-x;position:absolute;top:10%;left:0;right:0;height:300px}.table.hide{transform:scaleY(2.5)}.cat{position:relative;z-index:10}.cat.hide{transform:translateY(-200px)}.cop1,.cop2{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAADhAQMAAAAu4XPTAAAABlBMVEVHcEwAAACfKoRRAAAAAXRSTlMAQObYZgAAAN5JREFUeAFiQAaAduoQJ4MgBqDwNCNGViJ7DGSP1qv9R0LiiqVPbDMZdgkJ8kueflY0Vn4UR+brGyWrJ6ywwwFntcATXrDC1tjhgPPa0ng2Xo21sR3aH3Y86n/7w35v/AYv+rCfhx6dY9MOG6yw7DquPWhvbDdb/5jtl+3X1qz2y9/PrDY4qxfs1ZLVCnu1ZLXCDmf1hBV2OKsFnvCCtbE19sbROK8tjeem16a1sW3aNx2bzjPLoeeh16b1h22H9psdNzsbO6zwoA0e9IKH5Kckfu3wgkfAAg+Bx5iRry/vgS9iuUUnvwAAAABJRU5ErkJggg==);width:215px;height:399px;background-repeat:no-repeat;background-size:cover}.cop1{float:right}.cop1.hide{transform:translate(190px)}.cop2-wrapper{float:left;transform:scaleX(-1)}.cop2.hide{transform:translate(190px)}.cops{position:absolute;left:0;right:0;bottom:0;z-index:20;pointer-events:none}.box{border:5px ridge grey;background:#fff}.story-area{width:500px;height:150px;position:absolute;z-index:25;inset:0;margin:25% auto}.story-area.hide{transform:translateY(-550px)}.game-area-wrapper{position:absolute;inset:0;z-index:10;padding:4px}.game-area-wrapper.hide{transform:translateY(-600px)}.game-area{display:flex}.zones{position:relative;z-index:2;padding:1px;min-height:98px;max-height:196px;margin:0 2px 4px;text-align:left}.deck{width:86px;height:98px}.deck .c{background:#000;position:absolute;inset:0}.deck .c:after{background:#fff;content:"\1f0a0";position:absolute;inset:0;color:#000!important}.play,.discard{flex-grow:1}.discard .c:not(:last-child){width:20px;margin:0}.stats{flex-grow:1;min-width:110px}.controls{flex-grow:1;min-width:250px}.text-area,.story-area{padding:4px;overflow-x:auto;text-align:left}.text-area div:not(:last-child),.story-area div:not(:last-child){border-bottom:1px solid grey;margin:0 0 8px;padding:0 0 8px}
</style>
  </head>
  <body>

    <div class="main">
      <div class="table story"></div>
      <img class="cat story" src="/cat-final.png" alt="">
      <div class="cops">
        <div class="cop1 story"></div>
        <div class="cop2-wrapper">
          <div class="cop2 story"></div>
        </div>
      </div>
      <div class="story-area box story"><div>Bennet: Hello, I'm detective Bennet. I'll be cat translating through this interrogation (Tap on the text to proceed).</div></div>
      <div class="game-area-wrapper game hide">
        <div class="game-area">
          <div class="zones box deck zone-area"></div>
          <div class="zones box play zone-area"></div>
        </div>
        <div class="game-area">
          <div class="zones box discard zone-area"></div>
        </div>
        <div class="game-area">
          <div class="zones box stats">
            <div title="Total of all card values you've drawn. Go over max and you lose 20 hearts! 0 or less hearts and you lose!"><h2>Total: <span></span></h2></div>
            <div title="Don't go over this with your total!">Max: <span></span></div>
            <div title="Draw at least this many card before are able to pass the turn.">Required: <span></span></div>
            <h3 class="center">-Stashes-</h3>
            <div>♠: <span></span></div>
            <div>♥: <span></span></div>
            <div>♦: <span></span></div>
            <div>♣: <span></span></div>
            <div title="Win a round with 20 or more face cards in your deck and you win the game.">Faces: <span></span></div>
          </div>
          <div class="zones box text-area">Bennet: He says the rules are as follows. 
            <ul style="color:red">
              <li>The goal of the game is to get 20 face cards into your deck and then win a round.</li>
              <li>To start tap on the deck in the top left to draw a card.</li>
              <li>Draw at least 2 cards without exeeding the max of 23, similiar to Blackjack.</li>
              <li>If our total is exactly 23 after drawing we win the round!</li>
              <li>If we go over the max or have 0 hearts in our stash we immeditaly lose.</li>
              <li>You can pass at any time after you have drawn the required number of cards but if you are under your max that will be subtracted from your stash of hearts</li>
            </ul>
          </div>
          <div class="zones box controls">
            <div>Free: <button data-f="pass">Pass turn</button></div>
            <div>20x♣<button data-f="add">Add 2</button></div>
            <div>20x♠<button data-f="subtract">Subtract 3</button></div>
            <div>20x♦<button data-f="redraw">Redraw</button></div>
            <div>60x♠♣♦<button data-f="remove">Remove Card</button></div>
            <div>60x♠♣♦♥<button data-f="addFaceCard">Add Face Card</button></div>
          </div>
        </div>     
      </div>
    </div>


    <script>(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();let Z=["\u{1F0A2}","\u{1F0B2}","\u{1F0C2}","\u{1F0D2}","\u{1F0A3}","\u{1F0B3}","\u{1F0C3}","\u{1F0D3}","\u{1F0A4}","\u{1F0B4}","\u{1F0C4}","\u{1F0D4}","\u{1F0A5}","\u{1F0B5}","\u{1F0C5}","\u{1F0D5}","\u{1F0A6}","\u{1F0B6}","\u{1F0C6}","\u{1F0D6}","\u{1F0A7}","\u{1F0B7}","\u{1F0C7}","\u{1F0D7}","\u{1F0A8}","\u{1F0B8}","\u{1F0C8}","\u{1F0D8}","\u{1F0A9}","\u{1F0B9}","\u{1F0C9}","\u{1F0D9}","\u{1F0AA}","\u{1F0BA}","\u{1F0CA}","\u{1F0DA}"],Q=["\u{1F0AB}","\u{1F0BB}","\u{1F0CB}","\u{1F0DB}","\u{1F0AC}","\u{1F0BC}","\u{1F0CC}","\u{1F0DC}","\u{1F0AD}","\u{1F0BD}","\u{1F0CD}","\u{1F0DD}","\u{1F0AE}","\u{1F0BE}","\u{1F0CE}","\u{1F0DE}"],_=["\u{1F0A1}","\u{1F0B1}","\u{1F0C1}","\u{1F0D1}"],f="Mr. Fluffy Pants",F=["You &%$#, you're just toying with us aren't you!",`Is this a game to you!!! There's a backyard full of dead birds and it's got ${f} written all over it!`,"Well that orphanage certainly didn't burn itself down.","Don't play coy with me. I invented coy! I've got a goddamn patent on being coy!","You think you're tough! I eat pancakes shaped like your face for breakfast!","You think you're tough! I'll pett you 1 too many times!","You want to dance tough guy? I'll feed you 5 minutes after your normal dinner time!","I don't play by your rules","I get results","I'm getting too old for this &*^%","I'm a dog person","Would you like some fishy-lump treats? Well, tough! We're all out!"],ee={d1:["rI'm detective Rivera.",`b${f} do you understand why you are being questioned today?`,"cMeow","bYou are currently being held on the suspicion of number of crimes including, but not limited to, murder 1.","cMeow, hiss","rWhat'd he say! Was that about me?!? Look, you little hairball you're on thin ice. We've got so much dirt on you we're going to put you away for life! We have witnesses\u2026","bI'm sorry about my partner. They have a bit of a temper.","cMeow",`bYes ${f}`,"cMeow","bYes, uh huh","cMeow","bYes, I understand that but... there has to be some kind of understanding we can reach. We are prepared to offer you a good deal in exchange for information on the crime sydicate we know you are part of.","cMeow","bHe says he's thinking","cMeow, meow meow","bHe says he'd like to play a game. His game is blackjack but that might be boring for detectives as smart as us so he's spiced it up a bit.","bHe says if we win he game he'll answer any questions we have but if we lose he'll have nothing to say until his lawyer arrives.","rI'm not here to play games!!!!","bAgain I apologize for my partner... how can we say no to such an offer. Lets play your little game."]},N=["rTake that!","cMeow","bHe says well played but he still has nothing to say to us, just thanks for helping him pass the time",`rNo thank you ${f}. That's probably been long enough wouldn't you say detective Bennet?`,"bYes, we probably have everything we need by now","cMeow?",`bThat's correct ${f}, this was all a distraction to buy us enough time to raid the headquarters, of the most natorious feline crime syndicate in the city.`,"cMeow, meow, meow",`bYou're wrong ${f}, we will indeed find evidence we need to make a case against you because, you see, ${f} there's a mole in your organization and we know exactly where to look.`,"cMeow, meow, meow",`bHa no, this isn't a bluff, you're going away for a very, very, very long time ${f}.`],q=["cMeow, meow, meow","bHe says we've not only lost but we've waisted his time long enough, his little cat whiskers are sealed until his lawyer arrives. (click to play again)"],T=["t","m","r","s","h","d","c","l"],V=T.slice(3,7),te=D(Z,0),P=D(Q,9,!0),oe=_.map((e,t)=>({iconK:e,valueK:1,idK:V[t]}));function D(e,t,o){let a=0;return e.map((n,s)=>{let l=V[a];a++,a>3&&(a=0);let Y=Math.floor(s/4);return{idK:l+(Y+t),iconK:n,valueK:o?10:Y+2}})}let re={iconK:"\u{1F0DF}",valueK:15},g=!0,h=0,W=!1,M=1,u,w,d,c,m=!1,H=!1,r={tK:0,mK:23,rK:2,sK:0,hK:10,dK:0,cK:0,lK:0},K=e=>document.querySelectorAll(e),v=e=>document.querySelector(e),L=K(".zone-area"),R=v(".controls"),ae=R.querySelectorAll("div"),A=v(".text-area"),p=v(".story-area"),j=L[0],ne=L[1],B=L[2],se=K("span"),y=e=>({c0:!m,c1:r.cK>19,c2:r.sK>19,c3:r.dK>19,c4:r.sK>59&&r.cK>59&&r.dK>59,c5:r.sK>59&&r.cK>59&&r.dK>59&&r.hK>59})[e];const E=(e,t)=>e.appendChild(t.nodeK),C=e=>(e.nodeK=document.createElement("div"),e.nodeK.classList.add("c"),e.nodeK.textContent=e.iconK,e.nodeK.dataset.id=e.idK,e);let ie={pass:e=>{if(m)return;i("wWe pass the turn");let t=e.mK-e.tK;if(e.mK<e.tK){m=!0,z(!1);return}if(c.length<e.rK){i("bHe says you have to draw more cards to pass.",!0);return}r.hK-=t,i(`bWe lost ${t} hearts`),t>5&&t<10&&i("cMeow"),t>10&&i("cPurrr"),t<5&&i("cHisss"),x(c,d,c.length)},add:e=>{y("c1")&&(r.cK-=20,e.tK+=2,i("wWe use the add 2 ability"))},subtract:e=>{y("c2")&&(r.sK-=20,e.tK-=3,i("wWe use the subtract 3 ability"),e.tK<0&&i("cHe says: Very tricky"))},redraw:e=>{y("c3")&&(r.dK-=20,x(c.reverse(),d,1),G(),i("wWe redraw the last card"))},remove:e=>{if(i("bMr. Fluffy says you can click on a discarded card to remove it from your deck forever!",!0),d&&d.length===0){i("bHe says you need to have at least 1 card in your discard!",!0);return}y("c4")&&(r.sK-=60,r.cK-=60,r.dK-=60,W=!0)},addFaceCard:e=>{if(y("c5")){r.sK-=60,r.cK-=60,r.dK-=60,r.hK-=60;let t=P[$(0,P.length)];t=C(t),d.push({...t}),u.push({...t}),r.mK+=1,console.log(r),i("bFor each face card added to your deck he'll raise the max by 1. If you win a round with 10 or more face cards you win the game and he'll tell us everything we want to know.",!0)}}};p.addEventListener("click",()=>{(m&&!q[h]||H&&!N[h])&&location.reload();let e;H?e=N[h]:m?e=q[h]:e=ee["d"+M][h],g&&e?(i(e),h++):(p.innerHTML="",g=!1,h=0,le())});function S(){K(".story").forEach(o=>{o.classList.remove("hide")}),v(".game").classList.add("hide")}function le(){v(".game").classList.remove("hide"),K(".story").forEach(o=>{o.classList.add("hide")})}R.addEventListener("click",e=>{!e.target.dataset.f||(ie[e.target.dataset.f](r),J(),b())});j.addEventListener("click",()=>{if(r.tK>23){i("bMr. Fluffly says that you went over 23. Either buy an ability or pass to lose the game (followed by meniacal cat laughter.)",!0);return}G()});function G(){if(w.length===0){let a=d.splice(0,d.length);X(a),w=[...a]}x(w,c,1);let e=c[c.length-1].idK.charAt(0),t=parseInt(c[c.length-1].idK.charAt(1),10);t>7&&i("r"+F[$(0,F.length)]),r[e+"K"]+=t+2;let o=0;r.tK=c.reduce((a,n)=>a+n.valueK,o),J(),b()}B.addEventListener("click",e=>{if(!(!W||!e.target.dataset.id)){for(let t=0;t<d.length;t++)e.target.dataset.id===d[t].idK&&(d.splice(t,1),b());for(let t=0;t<u.length;t++)e.target.dataset.id===u[t].idK&&(u.splice(t,1),b());W=!1}});U();function U(){u||(u=de()),r.tK=0,w=X([...u]),d=[],c=[],ce()}function ce(){b()}function b(){let t=[...K(".c")].map(function(o){return o.classList.remove("enable-transitions"),{el:o,first:o.getBoundingClientRect()}});L.forEach(o=>o.innerHTML=""),w.forEach(o=>E(j,o)),c.forEach(o=>E(ne,o)),d.forEach(o=>E(B,o)),se.forEach((o,a)=>{T[a]==="l"?(r.lK=O(),o.textContent=r.lK):o.textContent=r[T[a]+"K"]}),ae.forEach((o,a)=>{y("c"+a)?o.style.opacity="1":o.style.opacity="0.1"}),t.forEach(o=>{var a=o.el.getBoundingClientRect(),n={top:o.first.top-a.top,left:o.first.left-a.left};o.el.style.transform=`translate(${n.left}px, ${n.top}px)`,setTimeout(()=>{o.el.classList.add("enable-transitions"),o.el.style.transform=""},200)})}function de(){return te.map((t,o)=>(C(t),t))}function X(e){return e.map(t=>({value:t,sort:Math.random()})).sort((t,o)=>t.sort-o.sort).map(({value:t})=>t)}function x(e,t,o=1){if(e.length===0||o>e.length)return;e.length,e.splice(0,o).reverse().forEach(n=>t.push(n))}let k=e=>e.split("").sort(function(){return .5-Math.random()}).join("");function i(e,t,o){let a=document.createElement(o?"h2":"div"),n={w:"Detectives: ",c:`${f}: `,r:"Rivera: ",b:"Bennet: "};const s=e.substring(0,1);(g||t)&&(s==="c"&&I(k("hgklrsm"),.1),s==="r"&&I(k("acXUeTVbf"),.1),s==="b"&&I(k("ZYXUTV"),.1),s==="w"&&I(k("VVUXcZaXUTfYe"),.1));const l=e.substring(1);a.textContent=n[s]+l,t&&(a.style.color="red"),g?p.appendChild(a):A.appendChild(a),A.scrollTo(0,A.scrollHeight),p.scrollTo(0,p.scrollHeight)}function z(e){if(e){H=!0,g=!0,S(),i("bWe did it we won!",!0);return}m=!0,g=!0,S(),i("rGoddamit we lost!",!0)}function J(){if(r.tK===r.mK){if(O()>19){z(!0);return}i("rWe got 23!",!0,!0),i("bHe says that for winning a round he's added an Ace to our deck and a Joker. Aces add 1 to our total but 11 to our stash. Jokers add 15 to our total and nothing to our stash. Also, he's added 60 to our entire stash!");let t={...re,idK:"j"+M};t=C(t),u.push(t);let o=oe[$(0,3)],a={...o,idK:o.idK+(11+M)};a=C(a),u.push(a),M++,r.sK+=60,r.cK+=60,r.dK+=60,r.hK+=60,r.tK=0,r.rK+=1,U()}}function O(){let e=0;return u.forEach(t=>{parseInt(t.idK.substring(1),10)>8&&e++}),e}function $(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)}function I(e,t){if(!e)return;let o=+t;window.AudioContext=window.AudioContext||window.webkitAudioContext;let a=new AudioContext;if(!a)return;let n=a.createGain();for(let s=0;s<e.length;s++){let l=a.createOscillator();e[s=+s]&&e[s]!="0"&&(l.connect(n),n.connect(a.destination),l.start(s*o+.3),l.frequency.setValueAtTime(440*1.06**(-105+e.charCodeAt(s)),s*o+.3),l.type="sine",n.gain.setValueAtTime(.5,s*o+.3),n.gain.setTargetAtTime(.001,s*o+.3+.1,.05),l.stop(s*o+.3+o-.01))}}</script>
  </body>
</html>
